name: Cake

on: [push]

jobs:
  build:

    runs-on: windows-latest

    steps:
    - uses: actions/checkout@v2
    
    - name: Setup .NET Core
      uses: actions/setup-dotnet@v1
      with:
        dotnet-version: ${{ matrix.dotnet }}
        
    #- name: Start Docker for MSSSql
    #  run: docker run -e 'ACCEPT_EULA=Y' -e 'SA_PASSWORD=sqlPw3$secure' -e 'MSSQL_PID=Developer' -p 1433:1433 --name msssql -d mcr.microsoft.com/mssql/server:2019-latest
      
    #- name: Start Docker for Mongodb
    #  run: docker run -d -p 27017:27017 mongo
      
    #- name: Dump mssql docker logs
    #  run: docker logs msssql 
    - name: Build with cake
      uses: ecampidoglio/cake-action@master
      env:
        NSTORE_MONGODB: mongodb://localhost/nstore
        NSTORE_MSSQL: Server=localhost;user id=sa;password=sqlPw3$secure
      with:
        script-path: build.cake
        target: ReleaseBuild  
        
